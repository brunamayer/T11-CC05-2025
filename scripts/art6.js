const pikachuSVG = `
<svg width="190" height="174" viewBox="0 0 190 174" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M27.5199 16.8986L27.4653 16.8138L27.3949 16.7416C21.0338 10.2208 14.8584 6.05741 10.2482 3.66641C7.94708 2.47297 6.01665 1.71116 4.63282 1.32184C3.95202 1.13031 3.35015 1.01348 2.88155 1.00111C2.66154 0.995306 2.36803 1.00819 2.09087 1.11816C2.00643 1.15166 1.90665 1.20082 1.80646 1.27339C1.4836 1.40639 1.30514 1.65254 1.2165 1.81778C1.0486 2.13079 1.01519 2.49839 1.00448 2.74706C0.980078 3.31326 1.0579 4.10615 1.2013 5.02026C1.49243 6.87617 2.09363 9.47146 2.93702 12.3071C4.6116 17.9374 7.30981 24.75 10.5961 28.6292L10.6362 28.6766L10.6819 28.7186C12.2 30.1159 13.8046 31.6393 15.4374 33.1896C19.4418 36.9915 23.6163 40.9549 27.1036 43.616C28.3404 44.5599 29.5187 45.3624 30.5971 45.9458C30.9884 46.1575 31.378 46.3467 31.762 46.5044C28.7368 51.4841 27 57.2923 27 63.5C27 64.2388 27.0246 64.972 27.0731 65.6988C24.4858 69.064 23 72.8969 23 77C23 81.7529 24.9937 86.1431 28.3834 89.8639C22.5056 98.6613 19 109.865 19 122C19 149.972 37.6276 173 61 173C84.3724 173 103 149.972 103 122C103 109.865 99.4944 98.6613 93.6166 89.8639C97.0063 86.1431 99 81.7529 99 77C99 73.3951 97.8531 69.9988 95.82 66.945C95.939 65.8126 96 64.6633 96 63.5C96 57.1431 94.1787 51.2052 91.0177 46.147C91.1458 46.0826 91.2742 46.0154 91.4029 45.9458C92.4813 45.3624 93.6596 44.5599 94.8964 43.616C98.3837 40.9549 102.558 36.9914 106.563 33.1896C108.195 31.6393 109.8 30.1159 111.318 28.7186L111.364 28.6766L111.404 28.6292C114.69 24.75 117.388 17.9374 119.063 12.3071C119.906 9.47146 120.508 6.87617 120.799 5.02026C120.942 4.10615 121.02 3.31326 120.996 2.74706C120.985 2.49839 120.951 2.13079 120.784 1.81778C120.695 1.65254 120.516 1.40638 120.194 1.27339C120.093 1.20081 119.994 1.15166 119.909 1.11816C119.632 1.00819 119.338 0.995306 119.118 1.00111C118.65 1.01348 118.048 1.13031 117.367 1.32184C115.983 1.71116 114.053 2.47297 111.752 3.66641C107.142 6.05741 100.966 10.2208 94.6051 16.7416L94.5347 16.8138L94.4801 16.8986C93.2997 18.7319 91.8556 20.7988 90.3472 22.9577C89.8636 23.6498 89.3735 24.3513 88.8833 25.0576C86.8766 27.9491 84.875 30.9131 83.4004 33.5467C82.824 34.5761 82.3198 35.5694 81.9251 36.4997C76.2032 32.4127 69.1377 30 61.5 30C53.5158 30 46.1569 32.6365 40.3046 37.0663C39.8847 35.9769 39.2947 34.788 38.5996 33.5467C37.125 30.9131 35.1234 27.9491 33.1167 25.0576C32.6265 24.3513 32.1363 23.6497 31.6528 22.9577C30.1444 20.7988 28.7002 18.7319 27.5199 16.8986Z" fill="#F6C64C" stroke="#BC700C" stroke-width="2"/>
<path d="M95.3209 17.4399C95.3209 17.4399 100.9 16.5 106.5 20.5C110 23 110.641 29.5 110.641 27.9828C116.926 20.5638 121.247 1.4303 119.676 2.21126C119.676 1.03982 107.891 4.55413 95.3209 17.4399Z" fill="black"/>
<path d="M26.6791 17.4399C26.6791 17.4399 21.1 16.5 15.5 20.5C12 23 11.3591 29.5 11.3591 27.9828C5.07399 20.5638 0.752969 1.4303 2.32425 2.21126C2.32425 1.03982 14.1088 4.55413 26.6791 17.4399Z" fill="black"/>
<circle cx="44" cy="63" r="7" fill="black"/>
<circle cx="46.5" cy="60.5" r="2.5" fill="#957973"/>
<circle cx="46.5" cy="60.5" r="2.5" fill="#957973"/>
<ellipse cx="61.5" cy="71" rx="2.5" ry="1" fill="black"/>
<circle cx="80" cy="63" r="7" fill="black"/>
<circle cx="89" cy="77" r="6.5" fill="#FF3333" stroke="black"/>
<circle cx="82.5" cy="60.5" r="2.5" fill="#957973"/>
<circle cx="82.5" cy="60.5" r="2.5" fill="#957973"/>
<circle cx="33" cy="77" r="6.5" fill="#FF3333" stroke="black"/>
<path d="M50 78C54.3527 85.2444 59.5627 81.0185 61.6237 78C64.0968 81.0185 69.8344 85.2444 73 78" stroke="#BC700C"/>
<path d="M125.73 87.3125L133.781 101.161L117.426 102.471L116.091 102.578L116.573 103.827L123.7 122.303L117.32 123.69L111.568 101.671L126.435 97.654L127.797 97.286L126.998 96.1227L109.815 71.0937L173.583 45.0979L186.509 89.9692L126.664 85.8123L124.782 85.6816L125.73 87.3125Z" fill="#F6C64C" stroke="#BC700C" stroke-width="2"/>
<path d="M73 98.1645C73 101.94 67.8513 105 61.5 105C55.1487 105 50 101.94 50 98.1645C50 94.3894 55.1487 96.6998 61.5 96.6998C67.8513 96.6998 73 94.3894 73 98.1645Z" fill="#BC700C"/>
</svg>
`; 

const parser = new DOMParser();
const svgElement = parser.parseFromString(pikachuSVG, "image/svg+xml").documentElement;

const pikachuGroup = d3.select("#art6").node().appendChild(svgElement);

const pokeballPos = [150, 150]; // POSIÇÃO DA POKEBOLA NA TELA

const art6 = d3.select("#art6")
    .attr("width", 600)
    .attr("height", 600);

// define máscara de recorte
const defs = art6.append("defs");
const mask = defs.append("mask").attr("id", "cutoutMask");

// grupo principal onde a pokebola está
const group = art6.append("g").attr("transform", `translate(${pokeballPos[0]}, ${pokeballPos[1]})`);

let open = 100; // quão aberta a pokebola está

mask.append("rect")
    .attr("width", 600)
    .attr("height", 600)
    .attr("transform", "translate(-10, -10)")
    .attr("fill", "white");

const innerCutout = mask.append("ellipse")
    .attr("cx", 150)
    .attr("cy", 150)
    .attr("rx", 135)
    .attr("ry", open - 10)
    .attr("fill", "black");

mask.append("rect")
    .attr("y", 300)
    .attr("width", 600)
    .attr("height", 300)
    .attr("fill", "white");

group.append("circle")
    .attr("cx", 150)
    .attr("cy", 150)
    .attr("r", 150)
    .attr("fill", "black");

const pikachu = d3.select(svgElement)
    .attr("x", 80)
    .attr("y", 100)

group.node().appendChild(pikachu.node()); // append do svg do pikachu no grupo da pokebola

group.append("path")
    .attr("d", "M300 150C300 110.218 284.196 72.0644 256.066 43.934C227.936 15.8035 189.782 3.00349e-06 150 0C110.218 -3.00349e-06 72.0645 15.8035 43.934 43.934C15.8035 72.0644 6.00699e-06 110.218 0 150L150 150H300Z")
    .attr("fill", "#CF4141")
    .attr("stroke", "black")
    .attr("stroke-width", 10)
    .attr("mask", "url(#cutoutMask)");

group.append("ellipse")
    .attr("cx", 203)
    .attr("cy", 44)
    .attr("rx", 23)
    .attr("ry", 21)
    .attr("fill", "#E35757")
    .attr("mask", "url(#cutoutMask)");


const topCutout = group.append("ellipse")
    .attr("cx", 150)
    .attr("cy", 150)
    .attr("rx", 145)
    .attr("ry", open-5)
    .attr("fill", "#542219")
    .attr("mask", "url(#cutoutMask)");

group.append("path")
    .attr("d", "M2.14537e-06 150C5.62327e-06 189.782 15.8035 227.936 43.934 256.066C72.0644 284.196 110.218 300 150 300C189.782 300 227.936 284.196 256.066 256.066C284.196 227.936 300 189.782 300 150L150 150L2.14537e-06 150Z")
    .attr("stroke", "black")
    .attr("stroke-width", 10)
    .attr("fill", "white");

const outerButton = group.append("ellipse")
    .attr("cx", 150)
    .attr("cy", 150 - open)
    .attr("rx", 35)
    .attr("ry", 35 - open / 9)
    .attr("fill", "gray")
    .attr("stroke", "black")
    .attr("stroke-width", 10);

const innerButton = group.append("ellipse")
    .attr("cx", 150)
    .attr("cy", 150 - open * 1.04)
    .attr("rx", 30)
    .attr("ry", 30 - open / 9)
    .attr("fill", "#b5b5b5")
    .attr("stroke", "black")
    .attr("stroke-width", 4);

function updateOpen(y) {
    open = y/1.5
    if (open > 150) {
        open = 150;
    } else if (open <= 0) {
        open = 0;
    }

    // atualiza elementos interativos
    topCutout.attr("ry", Math.max(0, open - 5));
    innerCutout.attr("ry", Math.max(0, open - 15));
    outerButton.attr("cy", 150 - open).attr("ry", 35 - open / 9);
    innerButton.attr("cy", 150 - open * 1.04).attr("ry", 30 - open / 9);
    pikachu.attr("y", 80 - open/4);
}

// listener do ponteiro mouse
art6.on("mousemove", function (event) {
    const [x, y] = d3.pointer(event);
    updateOpen(200 + pokeballPos[1] - y);
});